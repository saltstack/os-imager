---
kind: pipeline
name: lint-arch-2019-01-09

platform:
  os: linux
  arch: amd64

steps:
- name: lint-arch-2019-01-09
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=arch OS_REV=2019-01-09

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-centos-6

platform:
  os: linux
  arch: amd64

steps:
- name: lint-centos-6
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=centos OS_REV=6

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-centos-7

platform:
  os: linux
  arch: amd64

steps:
- name: lint-centos-7
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=centos OS_REV=7

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-debian-8

platform:
  os: linux
  arch: amd64

steps:
- name: lint-debian-8
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=debian OS_REV=8

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-debian-9

platform:
  os: linux
  arch: amd64

steps:
- name: lint-debian-9
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=debian OS_REV=9

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-fedora-28

platform:
  os: linux
  arch: amd64

steps:
- name: lint-fedora-28
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=fedora OS_REV=28

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-fedora-29

platform:
  os: linux
  arch: amd64

steps:
- name: lint-fedora-29
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=fedora OS_REV=29

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-opensuse-15

platform:
  os: linux
  arch: amd64

steps:
- name: lint-opensuse-15
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=opensuse OS_REV=15

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-opensuse-42.3

platform:
  os: linux
  arch: amd64

steps:
- name: lint-opensuse-42.3
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=opensuse OS_REV=42.3

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-ubuntu-1404

platform:
  os: linux
  arch: amd64

steps:
- name: lint-ubuntu-1404
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=ubuntu OS_REV=1404

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-ubuntu-1604

platform:
  os: linux
  arch: amd64

steps:
- name: lint-ubuntu-1604
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=ubuntu OS_REV=1604

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-ubuntu-1804

platform:
  os: linux
  arch: amd64

steps:
- name: lint-ubuntu-1804
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=ubuntu OS_REV=1804

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-windows-2012r2

platform:
  os: linux
  arch: amd64

steps:
- name: lint-windows-2012r2
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=windows OS_REV=2012r2

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-windows-2016

platform:
  os: linux
  arch: amd64

steps:
- name: lint-windows-2016
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=windows OS_REV=2016

trigger:
  event:
  - pull_request

---
kind: pipeline
name: lint-windows-2019

platform:
  os: linux
  arch: amd64

steps:
- name: lint-windows-2019
  image: hashicorp/packer
  commands:
  - apk --no-cache add make
  - make validate OS=windows OS_REV=2019

trigger:
  event:
  - pull_request

---
kind: pipeline
name: build-arch-2019-01-09-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=arch OS_REV=2019-01-09 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-arch-2019-01-09-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=arch OS_REV=2019-01-09 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-arch-2019-01-09-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=arch OS_REV=2019-01-09 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-arch-2019-01-09-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=arch OS_REV=2019-01-09 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-6-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=6 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-6-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=6 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-6-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=6 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-6-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=6 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-7-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=7 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-7-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=7 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-7-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=7 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-centos-7-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=centos OS_REV=7 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-8-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=8 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-8-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=8 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-8-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=8 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-8-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=8 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-9-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=9 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-9-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=9 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-9-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=9 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-debian-9-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=debian OS_REV=9 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-28-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=28 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-28-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=28 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-28-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=28 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-28-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=28 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-29-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=29 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-29-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=29 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-29-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=29 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-fedora-29-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=fedora OS_REV=29 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-15-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=15 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-15-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=15 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-15-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=15 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-15-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=15 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-42.3-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=42.3 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-42.3-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=42.3 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-42.3-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=42.3 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-opensuse-42.3-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=opensuse OS_REV=42.3 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1404-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1404 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1404-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1404 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1404-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1404 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1404-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1404 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1604-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1604 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1604-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1604 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1604-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1604 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1604-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1604 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1804-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1804 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1804-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1804 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1804-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1804 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-ubuntu-1804-develop

platform:
  os: linux
  arch: amd64

steps:
- name: throttle build
  image: alpine
  commands:
  - "sh -c 't=$(shuf -i 20-61 -n 1); echo Sleeping $t seconds; sleep $t'"

- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=ubuntu OS_REV=1804 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2012r2-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2012r2 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2012r2-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2012r2 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2012r2-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2012r2 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2012r2-develop

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2012r2 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2016-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2016 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2016-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2016 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2016-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2016 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2016-develop

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2016 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2019-2017.7

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2019 SALT_BRANCH=2017.7
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2019-2018.3

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2019 SALT_BRANCH=2018.3
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2019-2019.2

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2019 SALT_BRANCH=2019.2
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: pipeline
name: build-windows-2019-develop

platform:
  os: linux
  arch: amd64

steps:
- name: ci-image
  image: hashicorp/packer
  commands:
  - apk --no-cache add make curl grep gawk sed
  - make build OS=windows OS_REV=2019 SALT_BRANCH=develop
  environment:
    AWS_ACCESS_KEY_ID:
      from_secret: username
    AWS_DEFAULT_REGION: us-west-2
    AWS_SECRET_ACCESS_KEY:
      from_secret: password

trigger:
  branch:
  - ci
  event:
  - push

---
kind: secret
type: general
data:
  password: >
    ood6DhiPeWBKZfSOqhsq-iJPmkfnrbdIonynU7Hdd_gTk4eeii_l4cbit9O3
    s5P-iX3CWa_v6RwKtKz9vQd6V0MuphwGxRAcSC1z4O3R0g==
  username: >
    I0tTPep0OuH_qwx5v5-cr4gONWEDbccbJ4yShpI369wV5WYYRuq1Gckx40A6
    _OK_ypQ4AfAiDjEsC2U=

---
kind: signature
hmac: ff3784b4fd34d5a1fddc299620661d46885f621f15c6056fb2d2b6b41b3c18aa

...
